{% extends "base.html" %}

{% block title %}{{ tema.titulo }} - C√°lculo Integral{% endblock %}

{% block content %}
<div class="tema-contenido">
    <div class="tema-header">
        <h1>{{ tema.titulo }}</h1>
        <p>{{ tema.descripcion }}</p>
    </div>

    {% if tema.contenido.introduccion %}
    <div class="seccion">
        <h3>Introducci√≥n</h3>
        <p>{{ tema.contenido.introduccion }}</p>
    </div>
    {% endif %}

    <!-- Temas para Conceptos B√°sicos -->
    {% if tema.contenido.temas %}
    {% for item in tema.contenido.temas %}
    <div class="seccion">
        <h3>{{ item.nombre }}</h3>
        <p>{{ item.explicacion }}</p>
        {% if item.formula %}
        <div class="formula">
            {{ item.formula }}
        </div>
        {% endif %}
        {% if item.ejemplo %}
        <div class="ejemplo">
            <h4>üí° Ejemplo:</h4>
            <p>{{ item.ejemplo }}</p>
        </div>
        {% endif %}
    </div>
    {% endfor %}
    {% endif %}

    <!-- Pasos para Suma de Riemann -->
    {% if tema.contenido.pasos %}
    <div class="seccion">
        <h3>Pasos a Seguir</h3>
        <ol>
            {% for paso in tema.contenido.pasos %}
            <li>{{ paso }}</li>
            {% endfor %}
        </ol>
    </div>
    {% endif %}

    <!-- F√≥rmula principal -->
    {% if tema.contenido.formula %}
    <div class="seccion">
        <h3>F√≥rmula Principal</h3>
        <div class="formula">
            {{ tema.contenido.formula }}
        </div>
    </div>
    {% endif %}

    <!-- Propiedades -->
    {% if tema.contenido.propiedades %}
    <div class="seccion">
        <h3>Propiedades Importantes</h3>
        <ul>
            {% for prop in tema.contenido.propiedades %}
            <li>
                <strong>{{ prop }}</strong>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    <!-- Reglas B√°sicas -->
    {% if tema.contenido.reglas_basicas %}
    <div class="seccion">
        <h3>Reglas B√°sicas</h3>
        {% for regla in tema.contenido.reglas_basicas %}
        <div style="margin: 1.5em 0; padding: 1em; background: var(--crema); border-radius: 10px;">
            <h4>{{ regla.descripcion }}</h4>
            <div class="formula">
                {{ regla.formula }}
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- Teorema -->
    {% if tema.contenido.teorema %}
    <div class="seccion">
        <h3>Teorema Fundamental</h3>
        <div class="formula">
            {{ tema.contenido.teorema }}
        </div>
    </div>
    {% endif %}

    <!-- Casos Especiales -->
    {% if tema.contenido.casos_especiales %}
    <div class="seccion">
        <h3>Casos Especiales</h3>
        <ul>
            {% for caso in tema.contenido.casos_especiales %}
            <li>{{ caso }}</li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    <!-- M√©todos -->
    {% if tema.contenido.metodos %}
    <div class="seccion">
        <h3>M√©todos de C√°lculo</h3>
        <ol>
            {% for metodo in tema.contenido.metodos %}
            <li>{{ metodo }}</li>
            {% endfor %}
        </ol>
    </div>
    {% endif %}

    <!-- F√≥rmula del Disco -->
    {% if tema.contenido.formula_disco %}
    <div class="seccion">
        <h3>M√©todo de Discos</h3>
        <div class="formula">
            {{ tema.contenido.formula_disco }}
        </div>
    </div>
    {% endif %}

    <!-- F√≥rmula del Cilindro -->
    {% if tema.contenido.formula_cilindro %}
    <div class="seccion">
        <h3>M√©todo de Capas Cil√≠ndricas</h3>
        <div class="formula">
            {{ tema.contenido.formula_cilindro }}
        </div>
    </div>
    {% endif %}

    <!-- Ejemplo en tema -->
    {% if tema.contenido.ejemplo %}
    <div class="ejemplo">
        <h4>üí° Ejemplo Completo:</h4>
        <p><strong>Problema:</strong> {{ tema.contenido.ejemplo.problema }}</p>
        <p><strong>Soluci√≥n:</strong> {{ tema.contenido.ejemplo.solucion }}</p>
    </div>
    {% endif %}

    <!-- Ejercicios -->
    <div class="seccion">
        <h3>Ejercicios Propuestos</h3>
        
        {% if tema.ejercicios %}
        <div class="quiz-container" id="quiz-{{ tema_id }}"></div>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const ejercicios{{ tema_id | replace('-', '_') }} = {{ tema.ejercicios | tojson }};
                console.log('Ejercicios cargados:', ejercicios{{ tema_id | replace('-', '_') }});
                if (typeof Quiz !== 'undefined') {
                    const quiz{{ tema_id | replace('-', '_') }} = new Quiz('quiz-{{ tema_id }}', ejercicios{{ tema_id | replace('-', '_') }});
                } else {
                    console.error('Quiz class no est√° definida');
                }
            });
        </script>
        {% else %}
        <p style="background: #ffe6e6; padding: 1em; border-radius: 10px; color: #c00;">
            ‚ö†Ô∏è No hay ejercicios disponibles para este tema a√∫n.
        </p>
        {% endif %}
    </div>

    <!-- Botones de navegaci√≥n -->
    <div style="text-align: center; margin-top: 3em; padding-top: 2em; border-top: 2px dashed var(--rosa-pastel);">
        <a href="/" class="btn btn-secondary">‚Üê Volver al inicio</a>
        <a href="/#temas" class="btn" style="margin-left: 1em;">Ver todos los temas ‚Üí</a>
    </div>
</div>
{% endblock %}
